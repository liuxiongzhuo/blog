+++
date = '2025-02-25T10:14:24+08:00'
draft = false
title = 'onedrive huggingface 图床'
slug = '2'
+++
### 用处
onedrive本来就有"嵌入"功能,把网盘的文件提取出外链,但是我发现得到的链接有个302跳转,并且跳转后不是图片,而是包含图片的html,好像不能直接做图床,于是我用playwright无头游览器,提取出图片,鉴于playwright安装要大约1G,我部署到抱脸上.
使用方法:通过onedrive"嵌入"功能获得url,例如[https://1drv.ms/i/c/31c90366ccabe857/IQIM4kIQkTxNT7uZ56m1vpYdAUOF_YexWwk9MrJxF3JTEtE?width=1920&height=1080](https://1drv.ms/i/c/31c90366ccabe857/IQIM4kIQkTxNT7uZ56m1vpYdAUOF_YexWwk9MrJxF3JTEtE?width=1920&height=1080),我们提取出userid 31c90366ccabe857和fileid IQIM4kIQkTxNT7uZ56m1vpYdAUOF_YexWwk9MrJxF3JTEtE ,复制我的空间[https://huggingface.co/spaces/hellometeor/img](https://huggingface.co/spaces/hellometeor/img)修改files/app.js代码的ALLOWED_USER_IDS,列表里面填上你的userid ,请求路径 /userid/fileid
### 原理
playwright 无头游览器
### nginx 反向代理
```conf
server {
    listen 80;
    listen [::]:80;
    server_name 你的域名;

    location / {
        proxy_pass https://space域名 ;
        proxy_ssl_server_name on;
        proxy_set_header Host space域名 ;
    }
}
```
### cloudflare 缓存规则
主机名等于"你的域名"
缓存资格=符合缓存条件
边缘 TTL = 1 年
浏览器 TTL = 1 年